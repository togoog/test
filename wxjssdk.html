<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>微信jsapi测试-V型知识库</title>
		<!--<meta name="viewport" content="width=320.1,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no">-->
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<meta http-equiv="Access-Control-Allow-Origin" content="*">
		<script src="js/jquery.min.js"></script>
		<script src="js/jweixin-1.1.0.js"></script>
		<script src="js/sha.js"></script>
		<style type="text/css">
			.desc {
				color: red;
			}
			
			html {
				-ms-text-size-adjust: 100%;
				-webkit-text-size-adjust: 100%;
				-webkit-user-select: none;
				user-select: none;
			}
			
			body {
				line-height: 1.6;
				font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
				background-color: #f1f0f6;
			}
			
			* {
				margin: 0;
				padding: 0;
			}
			
			button {
				font-family: inherit;
				font-size: 100%;
				margin: 0;
				*font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			}
			
			ul,
			ol {
				padding-left: 0;
				list-style-type: none;
			}
			
			a {
				text-decoration: none;
			}
			
			.label_box {
				background-color: #ffffff;
			}
			
			.label_item {
				padding-left: 15px;
			}
			
			.label_inner {
				padding-top: 10px;
				padding-bottom: 10px;
				min-height: 24px;
				position: relative;
			}
			
			.label_inner:before {
				content: " ";
				position: absolute;
				left: 0;
				top: 0;
				width: 200%;
				height: 1px;
				border-top: 1px solid #ededed;
				-webkit-transform-origin: 0 0;
				transform-origin: 0 0;
				-webkit-transform: scale(0.5);
				transform: scale(0.5);
				top: auto;
				bottom: -2px;
			}
			
			.lbox_close {
				position: relative;
			}
			
			.lbox_close:before {
				content: " ";
				position: absolute;
				left: 0;
				top: 0;
				width: 200%;
				height: 1px;
				border-top: 1px solid #ededed;
				-webkit-transform-origin: 0 0;
				transform-origin: 0 0;
				-webkit-transform: scale(0.5);
				transform: scale(0.5);
			}
			
			.lbox_close:after {
				content: " ";
				position: absolute;
				left: 0;
				top: 0;
				width: 200%;
				height: 1px;
				border-top: 1px solid #ededed;
				-webkit-transform-origin: 0 0;
				transform-origin: 0 0;
				-webkit-transform: scale(0.5);
				transform: scale(0.5);
				top: auto;
				bottom: -2px;
			}
			
			.lbox_close .label_item:last-child .label_inner:before {
				display: none;
			}
			
			.btn {
				display: block;
				margin-left: auto;
				margin-right: auto;
				padding-left: 14px;
				padding-right: 14px;
				font-size: 18px;
				text-align: center;
				text-decoration: none;
				overflow: visible;
				/*.btn_h(@btnHeight);*/
				height: 42px;
				border-radius: 5px;
				-moz-border-radius: 5px;
				-webkit-border-radius: 5px;
				box-sizing: border-box;
				-moz-box-sizing: border-box;
				-webkit-box-sizing: border-box;
				color: #ffffff;
				line-height: 42px;
				-webkit-tap-highlight-color: rgba(255, 255, 255, 0);
			}
			
			.btn.btn_inline {
				display: inline-block;
			}
			
			.btn_primary {
				background-color: #04be02;
			}
			
			.btn_primary:not(.btn_disabled):visited {
				color: #ffffff;
			}
			
			.btn_primary:not(.btn_disabled):active {
				color: rgba(255, 255, 255, 0.9);
				background-color: #039702;
			}
			
			button.btn {
				width: 100%;
				border: 0;
				outline: 0;
				-webkit-appearance: none;
			}
			
			button.btn:focus {
				outline: 0;
			}
			
			.wxapi_container {
				font-size: 16px;
			}
			
			h1 {
				font-size: 14px;
				font-weight: 400;
				line-height: 2em;
				padding-left: 15px;
				color: #8d8c92;
			}
			
			.desc {
				font-size: 14px;
				font-weight: 400;
				line-height: 2em;
				color: #8d8c92;
			}
			
			.wxapi_index_item a {
				display: block;
				color: #3e3e3e;
				-webkit-tap-highlight-color: rgba(0, 0, 0, 0);
			}
			
			.wxapi_form {
				background-color: #ffffff;
				padding: 0 15px;
				margin-top: 30px;
				padding-bottom: 15px;
			}
			
			h3 {
				padding-top: 16px;
				margin-top: 25px;
				font-size: 16px;
				font-weight: 400;
				color: #3e3e3e;
				position: relative;
			}
			
			h3:first-child {
				padding-top: 15px;
			}
			
			h3:before {
				content: " ";
				position: absolute;
				left: 0;
				top: 0;
				width: 200%;
				height: 1px;
				border-top: 1px solid #ededed;
				-webkit-transform-origin: 0 0;
				transform-origin: 0 0;
				-webkit-transform: scale(0.5);
				transform: scale(0.5);
			}
			
			.btn {
				margin-bottom: 15px;
			}
		</style>
	</head>

	<body>
		<center>
			<h3>欢迎来到微信jsapi测试界面-V型知识库</h3></center>
		<div class="lbox_close wxapi_form">
			<h3 id="menu-scan">微信扫一扫</h3>
			<span>调起微信扫一扫接口</span>
			<button class="btn btn_primary" id="scanQRCode0">scanQRCode</button> <button class="btn btn_primary" id="scanQRCode1">scanQRCode(直接返回结果)</button>
			<!--<iframe src="weixincamer.html" width="480" height="320" seamless></iframe>-->
		</div>
		<div style="display: none;">
			<h3 id="menu-webview">界面操作接口</h3><br>
			<span>隐藏右上角菜单接口</span>
			<br>
			<button class="btn btn_primary" id="hideOptionMenu">hideOptionMenu</button>
			<br>
			<span>显示右上角菜单接口</span>
			<br>
			<button class="btn btn_primary" id="showOptionMenu">showOptionMenu</button>
			<br>
			<span>关闭当前网页窗口接口</span>
			<br>
			<button class="btn btn_primary" id="closeWindow">closeWindow</button>
			<br>
			<span>批量隐藏功能按钮接口</span>
			<br>
			<button class="btn btn_primary" id="hideMenuItems">hideMenuItems</button>
			<br>
			<span>批量显示功能按钮接口</span>
			<br>
			<button class="btn btn_primary" id="showMenuItems">showMenuItems</button>
			<br>
			<span>隐藏所有非基础按钮接口</span>
			<br>
			<button class="btn btn_primary" id="hideAllNonBaseMenuItem">hideAllNonBaseMenuItem</button>
			<br>
			<span>显示所有功能按钮接口</span>
			<br>
			<button class="btn btn_primary" id="showAllNonBaseMenuItem">showAllNonBaseMenuItem</button><br>
			<p>基础接口之判断当前客户端是否支持指定的js接口</p>
			<input type="button" value="checkJSAPI" id="checkJsApi"><br>
			<span style="color: red">地理位置接口-使用微信内置地图查看位置接口</span>
			<br>
			<button class="btn btn_primary" id="openLocation">openLocation</button>
			<br>
			<span style="color: red">地理位置接口-获取地理位置接口</span>
			<br>
			<button class="btn btn_primary" id="getLocation">getLocation</button>
			<br>
			<span style="color: red">获取网络状态接口</span>
			<br>
			<button class="btn btn_primary" id="getNetworkType">getNetworkType</button>
			<br>
			<h3 id="menu-image">图像接口</h3>
			<span>拍照或从手机相册中选图接口</span><br>
			<button class="btn btn_primary" id="chooseImage">chooseImage</button>
			<br>
			<span>预览图片接口</span><br>
			<button class="btn btn_primary" id="previewImage">previewImage</button><br>
			<span>上传图片接口</span><br>
			<button class="btn btn_primary" id="uploadImage">uploadImage</button><br>
			<span>下载图片接口</span><br>
			<button class="btn btn_primary" id="downloadImage">downloadImage</button>
			<br>
			<br> 显示图片
			<img src="http://" id="faceImg">
		</div>
		<script type="text/javascript">
			wx.config({
				debug: true, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。       
				appId: '${appId}', // 必填，公众号的唯一标识       
				timestamp: '${ timestamp}', // 必填，生成签名的时间戳       
				nonceStr: '${ nonceStr}', // 必填，生成签名的随机串       
				signature: '${ signature}', // 必填，签名，见附录1       
				jsApiList: [
					'checkJsApi',
					'chooseImage',
					'previewImage',
					'uploadImage',
					'downloadImage',
					'getNetworkType', //网络状态接口                   
					'openLocation', //使用微信内置地图查看地理位置接口                   
					'getLocation', //获取地理位置接口                   
					'hideOptionMenu', //界面操作接口1                   
					'showOptionMenu', //界面操作接口2                   
					'closeWindow', ////界面操作接口3                   
					'hideMenuItems', ////界面操作接口4                   
					'showMenuItems', ////界面操作接口5                   
					'hideAllNonBaseMenuItem', ////界面操作接口6                   
					'showAllNonBaseMenuItem', ////界面操作接口7                   
					'scanQRCode' // 微信扫一扫接口                
				] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2   
			});
			wx.ready(function() {
				// 5 图片接口   
				// 5.1 拍照、本地选图
				var images = {
					localId: [],
					serverId: []
				};
				document.querySelector('#chooseImage').onclick = function() {
					wx.chooseImage({
						success: function(res) {
							images.localId = res.localIds;
							alert('已选择 ' + res.localIds.length + ' 张图片');
							$("#faceImg").attr("src", res.localIds[0]);
							//显示图片到页面上       
						}
					});
				};
				// 5.2 图片预览   
				document.querySelector('#previewImage').onclick = function() {
					wx.previewImage({
						urls: []
					});
				};
				// 5.3 上传图片   
				document.querySelector('#uploadImage').onclick = function() {
					if(images.localId.length == 0) {
						alert('请先使用 chooseImage 接口选择图片');
						return;
					}
					var i = 0,
						length = images.localId.length;
					images.serverId = [];

					function upload() {
						wx.uploadImage({
							localId: images.localId[i],
							success: function(res) {
								i++;
								//alert('已上传：' + i + '/' + length);           
								images.serverId.push(res.serverId);
								if(i < length) {
									upload();
								}
							},
							fail: function(res) {
								alert(JSON.stringify(res));
							}
						});
					}
					upload();
				};
				// 5.4 下载图片   
				document.querySelector('#downloadImage').onclick = function() {
					if(images.serverId.length === 0) {
						alert('请先使用 uploadImage 上传图片');
						return;
					}
					var i = 0,
						length = images.serverId.length;
					images.localId = [];

					function download() {
						wx.downloadImage({
							serverId: images.serverId[i],
							success: function(res) {
								i++;
								images.localId.push(res.localId);
								if(i < length) {
									download();
								}
							}
						});
					}
					download();
				};
				// 6 设备信息接口   
				// 6.1 获取当前网络状态   
				document.querySelector('#getNetworkType').onclick = function() {
					wx.getNetworkType({
						success: function(res) {
							alert;
						},
						fail: function(res) {
							alert(JSON.stringify(res));
						}
					});
				};
				//网络接口结束
				// 7 地理位置接口 开始  
				// 7.1 查看地理位置   
				document.querySelector('#openLocation').onclick = function() {
					wx.openLocation({
						latitude: 23.099994,
						longitude: 113.324520,
						name: 'TIT 创意园',
						address: '广州市海珠区新港中路 397 号',
						scale: 14,
					});
				};
				// 7.2 获取当前地理位置   
				document.querySelector('#getLocation').onclick = function() {
					wx.getLocation({
						success: function(res) {
							alert(JSON.stringify(res));
						},
						cancel: function(res) {
							alert('用户拒绝授权获取地理位置');
						}
					});
				};
				// 7 地理位置接口 结束    
				// 8 界面操作接口 开始-----------   
				// 8.1 隐藏右上角菜单   
				document.querySelector('#hideOptionMenu').onclick = function() {
					wx.hideOptionMenu();
				};
				// 8.2 显示右上角菜单   
				document.querySelector('#showOptionMenu').onclick = function() {
					wx.showOptionMenu();
				};
				// 8.3 批量隐藏菜单项   
				document.querySelector('#hideMenuItems').onclick = function() {
					wx.hideMenuItems({
						menuList: [
							'menuItem:readMode', // 阅读模式         
							'menuItem:share:timeline', // 分享到朋友圈         
							'menuItem:copyUrl' // 复制链接       
						],
						success: function(res) {
							alert('已隐藏“阅读模式”，“分享到朋友圈”，“复制链接”等按钮');
						},
						fail: function(res) {
							alert(JSON.stringify(res));
						}
					});
				};
				// 8.4 批量显示菜单项   
				document.querySelector('#showMenuItems').onclick = function() {
					wx.showMenuItems({
						menuList: [
							'menuItem:readMode', // 阅读模式         
							'menuItem:share:timeline', // 分享到朋友圈         
							'menuItem:copyUrl' // 复制链接       
						],
						success: function(res) {
							alert('已显示“阅读模式”，“分享到朋友圈”，“复制链接”等按钮');
						},
						fail: function(res) {
							alert(JSON.stringify(res));
						}
					});
				};
				// 8.5 隐藏所有非基本菜单项   
				document.querySelector('#hideAllNonBaseMenuItem').onclick = function() {
					wx.hideAllNonBaseMenuItem({
						success: function() {
							alert('已隐藏所有非基本菜单项');
						}
					});
				};
				// 8.6 显示所有被隐藏的非基本菜单项   
				document.querySelector('#showAllNonBaseMenuItem').onclick = function() {
					wx.showAllNonBaseMenuItem({
						success: function() {
							alert('已显示所有非基本菜单项');
						}
					});
				};
				// 8.7 关闭当前窗口   
				document.querySelector('#closeWindow').onclick = function() {
					wx.closeWindow();
				};
				// 8 界面操作接口  结束------------------------------------------  
				// 9 微信原生接口 开始---------------------
				// 9.1.1 扫描二维码并返回结果   
				document.querySelector('#scanQRCode0').onclick = function() {
					wx.scanQRCode();
				};
				// 9.1.2 扫描二维码并返回结果   document.querySelector('#scanQRCode1').onclick = function () {
				wx.scanQRCode({
					needResult: 1,
					desc: 'scanQRCode desc',
					success: function(res) {
						alert(JSON.stringify(res));
					}
				});
				// 9 微信原生接口 结束--------------------- 
			});
			//初始化jsapi接口 状态 
			wx.error(function(res) {
				alert;
			});
		</script>
	</body>

</html>